# 赔率设置功能说明

## 🎯 **功能概述**

新增了"赔率设置"配置功能，位于系统配置的第5个tab页（在下注类型右边），可以自定义六合彩各种下注类型的赔率和回水设置。

## 📋 **配置项详细说明**

### **1. 三中三赔率**
- **赔率设置**：默认 1:175（即投注1元中奖后获得175元）
- **回水率设置**：默认 5%（即投注金额的5%作为回水）
- **用途**：适用于所有三中三下注类型

### **2. 三中二赔率**（特殊：有两种赔率）
#### **中二个时的赔率**
- **赔率设置**：默认 1:7.5（即投注1元中两个号码获得7.5元）
- **回水率设置**：默认 5%
- **适用场景**：当三中二下注中了其中两个号码时

#### **中三个时的赔率**
- **赔率设置**：默认 1:175（即投注1元中三个号码获得175元）
- **回水率设置**：默认 5%
- **适用场景**：当三中二下注中了全部三个号码时

### **3. 二中二赔率**
- **赔率设置**：默认 1:7.5（即投注1元中奖后获得7.5元）
- **回水率设置**：默认 5%
- **用途**：适用于所有二中二下注类型

### **4. 特碰赔率**
- **赔率设置**：默认 1:40（即投注1元中奖后获得40元）
- **回水率设置**：默认 5%
- **用途**：适用于所有特碰下注类型

## 🖥️ **界面操作说明**

### **访问路径**
1. 启动六合彩机器人应用
2. 点击"系统配置"tab
3. 选择"赔率设置"sub-tab

### **配置界面布局**
```
赔率设置配置
├── 三中三赔率
│   ├── 赔率输入框
│   └── 回水率输入框
├── 三中二赔率
│   ├── 中二个时的赔率
│   │   ├── 赔率输入框  
│   │   └── 回水率输入框
│   └── 中三个时的赔率
│       ├── 赔率输入框
│       └── 回水率输入框
├── 二中二赔率
│   ├── 赔率输入框
│   └── 回水率输入框
├── 特碰赔率
│   ├── 赔率输入框
│   └── 回水率输入框
└── 操作按钮
    ├── 保存赔率配置
    └── 重置为默认
```

### **操作步骤**
1. **查看当前赔率**：打开界面即可看到所有当前的赔率设置
2. **修改赔率**：
   - 在对应的"赔率"输入框中输入新的赔率值（支持小数）
   - 在对应的"回水率(%)"输入框中输入新的回水率（0-1之间的小数）
3. **保存配置**：点击"保存赔率配置"按钮
4. **重置配置**：点击"重置为默认"按钮恢复所有默认设置

## 💡 **输入格式说明**

### **赔率格式**
- **输入类型**：数字（支持小数）
- **最小值**：0
- **步长**：0.1
- **示例**：`175.0`, `7.5`, `40.0`

### **回水率格式**
- **输入类型**：小数（0-1之间）
- **最小值**：0
- **最大值**：1
- **步长**：0.01
- **示例**：`0.05`（表示5%），`0.10`（表示10%）

## 📊 **配置文件格式**

```json
{
  "odds_config": {
    "three_of_three": {
      "odds_ratio": 175.0,
      "rebate": 0.05
    },
    "three_of_two": {
      "hit_two_odds": {
        "odds_ratio": 7.5,
        "rebate": 0.05
      },
      "hit_three_odds": {
        "odds_ratio": 175.0,
        "rebate": 0.05
      }
    },
    "two_of_two": {
      "odds_ratio": 7.5,
      "rebate": 0.05
    },
    "special": {
      "odds_ratio": 40.0,
      "rebate": 0.05
    }
  }
}
```

## 🔄 **API接口**

### **后端接口**
- `GetOddsConfig()` - 获取赔率配置
- `SaveOddsConfig(config)` - 保存赔率配置

### **前端接口**
- `goApi.getOddsConfig()` - 获取配置
- `goApi.saveOddsConfig(config)` - 保存配置

## 💰 **实际应用示例**

### **示例1：三中三下注**
- **用户下注**：三中三 1,2,3 各10元
- **当前赔率**：1:175，回水5%
- **中奖情况**：如果开奖结果包含1,2,3
- **计算结果**：
  - 奖金：10 × 175 = 1750元
  - 回水：10 × 0.05 = 0.5元
  - 总收益：1750 + 0.5 = 1750.5元

### **示例2：三中二下注（中两个）**
- **用户下注**：三中二 4,5,6 各20元
- **当前赔率**：中二个时1:7.5，回水5%
- **中奖情况**：如果开奖结果包含4,5（不包含6）
- **计算结果**：
  - 奖金：20 × 7.5 = 150元
  - 回水：20 × 0.05 = 1元
  - 总收益：150 + 1 = 151元

### **示例3：三中二下注（中三个）**
- **用户下注**：三中二 7,8,9 各20元
- **当前赔率**：中三个时1:175，回水5%
- **中奖情况**：如果开奖结果包含7,8,9
- **计算结果**：
  - 奖金：20 × 175 = 3500元
  - 回水：20 × 0.05 = 1元
  - 总收益：3500 + 1 = 3501元

## ⚡ **技术特性**

- ✅ **实时生效**：修改赔率后立即保存到文件并更新内存
- ✅ **数据验证**：前端输入验证，确保数据格式正确
- ✅ **持久化存储**：配置保存在JSON文件中，重启后自动加载
- ✅ **线程安全**：使用读写锁保护并发访问
- ✅ **错误恢复**：保存失败时有明确的错误提示
- ✅ **默认值保护**：如果配置文件损坏，自动使用默认值

## 🔒 **数据安全**

- **配置校验**：前端和后端都有数据格式校验
- **自动备份**：修改配置前自动备份原配置
- **回滚机制**：保存失败时自动回滚到之前状态
- **默认配置**：始终可以重置为系统默认配置

## 🎨 **界面设计特点**

- **分类清晰**：每种下注类型独立分组显示
- **直观易懂**：使用卡片式布局，信息层次分明
- **操作便捷**：支持数字输入框，自动步长调节
- **即时反馈**：保存和重置操作有明确的成功/失败提示

## 🚀 **扩展性**

这个赔率设置系统具有良好的扩展性：

- **新增下注类型**：只需在后端添加新的赔率结构，前端会自动适配
- **复杂赔率规则**：支持为不同彩种设置不同的赔率
- **动态配置**：可以根据市场情况实时调整赔率
- **多级回水**：可以扩展为支持多级回水设置

## 📈 **业务价值**

1. **灵活性**：庄家可以根据市场情况灵活调整赔率
2. **竞争力**：通过优化赔率提高平台竞争力
3. **风险控制**：通过调整赔率控制风险敞口
4. **用户体验**：透明的赔率设置提高用户信任度

这个赔率设置功能为六合彩机器人提供了强大的赔率管理能力！💎
